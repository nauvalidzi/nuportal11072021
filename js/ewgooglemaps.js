/**
 * Google Maps (Custom View Tag) for PHPMaker 2021
 * @license Copyright (c) e.World Technology Limited. All rights reserved.
 */
ew.googleMapIndex=0,ew.googleMapStyles=[[{url:ew.IMAGE_FOLDER+"people35.png",height:35,width:35,anchor:[16,0],textColor:"#ff00ff",textSize:10},{url:ew.IMAGE_FOLDER+"people45.png",height:45,width:45,anchor:[24,0],textColor:"#ff0000",textSize:11},{url:ew.IMAGE_FOLDER+"people55.png",height:55,width:55,anchor:[32,0],textColor:"#ffffff",textSize:12}],[{url:ew.IMAGE_FOLDER+"conv30.png",height:27,width:30,anchor:[3,0],textColor:"#ff00ff",textSize:10},{url:ew.IMAGE_FOLDER+"conv40.png",height:36,width:40,anchor:[6,0],textColor:"#ff0000",textSize:11},{url:ew.IMAGE_FOLDER+"conv50.png",width:50,height:45,anchor:[8,0],textSize:12}],[{url:ew.IMAGE_FOLDER+"heart30.png",height:26,width:30,anchor:[4,0],textColor:"#ff00ff",textSize:10},{url:ew.IMAGE_FOLDER+"heart40.png",height:35,width:40,anchor:[8,0],textColor:"#ff0000",textSize:11},{url:ew.IMAGE_FOLDER+"heart50.png",width:50,height:44,anchor:[12,0],textSize:12}],[{url:ew.IMAGE_FOLDER+"pin.png",height:48,width:30,anchor:[-18,0],textColor:"#ffffff",textSize:10,iconAnchor:[15,48]}]],ew.showGoogleMap=function(e){ew.googleMapIndex++;var o,t,a=jQuery,i=e.latlng,l=e.id,n=e.use_single_map,r=e.show_all_markers,g=e.use_marker_clusterer&&window.MarkerClusterer,s=function(o){if(a(document).trigger("map",[a.extend({index:ew.googleMapIndex},e,o||{})]),ew.googleMapIndex==ew.googleMaps.length)for(let e in ew.googleMaps)if(!a.isNumber(e)){var t=ew.googleMaps[e];t.markers&&!t.cluster&&(t.cluster=new MarkerClusterer(t.map,t.markers,t.options)),t.bounds&&t.map.fitBounds(t.bounds)}return!0};if(e.inited)return s();var p=function(e){a("#"+e+"[type='text/html']").each((function(){$scr=a(this),$scr.closest("td").find("span:first").append($scr.html())}))};if(!i)return p(e.template_id),n||a("#"+l).css({width:"",height:"",display:"inline-block"}).html(e.status).hide(),s();switch(e.type.toLowerCase()){case"satellite":o=google.maps.MapTypeId.SATELLITE;break;case"hybrid":o=google.maps.MapTypeId.HYBRID;break;case"terrain":o=google.maps.MapTypeId.TERRAIN;break;default:o=google.maps.MapTypeId.ROADMAP}var w={zoom:e.zoom||10,center:i,mapTypeId:o};if(n){if(p(e.template_id),!ew.googleMaps[l]){var d=a("<div></div>").attr("id",l).addClass("ew-google-map ew-single-map").height(e.single_map_height),h=a(".ew-grid, .ew-multi-column-grid").first();e.show_map_on_top?d.insertBefore(h.first()):d.insertAfter(h.first()),ew.googleMaps[l]={map:new google.maps.Map(d[0],w)},r&&(ew.googleMaps[l].bounds=new google.maps.LatLngBounds),g&&(ew.googleMaps[l].markers=[],ew.googleMaps[l].options={maxZoom:-1===e.cluster_max_zoom?null:e.cluster_max_zoom,gridSize:-1===e.cluster_grid_size?null:e.cluster_grid_size,styles:-1===e.cluster_styles?null:ew.googleMapStyles[e.cluster_styles],imagePath:ew.IMAGE_FOLDER+"m"})}}else ew.googleMaps[l]||(ew.googleMaps[l]={map:new google.maps.Map(a("#"+l)[0],w)});t=ew.googleMaps[l],e.inited=!0;var u=new google.maps.Marker({position:i,map:t.map,icon:e.icon||null,title:e.title||""});e.marker=u,n&&g&&t.markers.push(u);var c=(e.description||"").trim();if(c){var f=new google.maps.InfoWindow({content:c||""});e.infowindow=f,google.maps.event.addListener(u,"click",(function(){f.open(t.map,u)}))}return n&&r&&t.bounds.extend(i),s(t)},ew.initGoogleMaps=function(){var e=jQuery;ew.googleMapIndex=0,e.each(ew.googleMaps,(function(o,t){if(t.inited)ew.showGoogleMap(t);else{var a=t.address,i=t.latitude,l=t.longitude,n=t.geocoding_delay;a&&""!=a.trim()?e.later(o*n,null,(function(){(new google.maps.Geocoder).geocode({address:a},(function(e,o){o==google.maps.GeocoderStatus.OK?t.latlng=e[0].geometry.location:t.status=o,ew.showGoogleMap(t)}))})):(i&&!isNaN(i)&&l&&!isNaN(l)&&(t.latlng=new google.maps.LatLng(i,l)),ew.showGoogleMap(t))}}))},jQuery((function(e){ew.initGoogleMaps(),e("#ew-modal-dialog").on("load.ew",ew.initGoogleMaps),e(document).on("preview",ew.initGoogleMaps)}));